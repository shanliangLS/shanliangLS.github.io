<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nginx 笔记 | 钐椋的博客</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.2.0"></head><body><header><nav><a href="/">首页</a><a href="/archives/">归档</a></nav></header><main><article><div id="post-bg"><div id="post-title"><div id="post-info"><span>date:<time datetime="2022-09-01T07:05:00.000Z" id="date"> 2022-09-01</time></span><br><span>updated:<time datetime="2022-09-27T03:14:39.471Z" id="updated"> 2022-09-27</time></span></div><h1>Nginx 笔记</h1><hr></div><div id="post-content"><p>环境：CentOS 7.6+</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>从 <a target="_blank" rel="noopener" href="http://nginx.org/en/download.html">http://nginx.org/en/download.html</a> 下载 nginx-1.23.1.tar.gz</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar -zxvf nginx-1.23.1.tar.gz<br><span class="hljs-built_in">cd</span> nginx-1.23.1<br>./configure --prefix=/usr/<span class="hljs-built_in">local</span>/nginx<br>make &amp;&amp; make install<br></code></pre></td></tr></table></figure>

<p><code>/usr/local/nginx</code>：nginx 安装目录，可自定义位置</p>
<p>启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/<span class="hljs-built_in">local</span>/nginx/sbin/nginx<br></code></pre></td></tr></table></figure>

<p>重启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/<span class="hljs-built_in">local</span>/nginx/sbin/nginx -s reload<br></code></pre></td></tr></table></figure>

<p>停止</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/<span class="hljs-built_in">local</span>/nginx/sbin/nginx -s stop<br></code></pre></td></tr></table></figure>

<h3 id="安装新模块"><a href="#安装新模块" class="headerlink" title="安装新模块"></a>安装新模块</h3><p>如 sll 模块 ngx_http_ssl_module 和 日志模块 ngx_http_log_module</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar -zxvf nginx-1.23.1.tar.gz<br><span class="hljs-built_in">cd</span> nginx-1.23.1<br>./configure --prefix=/usr/<span class="hljs-built_in">local</span>/nginx --with-http_ssl_module --with-http_log_module<br>make<br><span class="hljs-comment"># 覆盖安装</span><br>make install<br><span class="hljs-comment"># 或者备份安装</span><br><span class="hljs-comment">#mv /usr/local/nginx/sbin/nginx /usr/local/nginx/sbin/nginx_back</span><br><span class="hljs-comment">#cp ./sbin/nginx /usr/local/nginx/sbin/ /usr/local/nginx/sbin/</span><br><span class="hljs-comment"># 重启</span><br>/usr/<span class="hljs-built_in">local</span>/nginx/sbin/nginx -s reload<br></code></pre></td></tr></table></figure>

<p>查看当前模块</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/<span class="hljs-built_in">local</span>/nginx/sbin/nginx -V<br></code></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>编辑 <code>/usr/local/nginx/conf/nginx.conf</code></p>
<h3 id="部署系统"><a href="#部署系统" class="headerlink" title="部署系统"></a>部署系统</h3><p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#user  nobody;</span><br>worker_processes  1;<br><br><span class="hljs-comment">#error_log  logs/error.log;</span><br><span class="hljs-comment">#error_log  logs/error.log  notice;</span><br><span class="hljs-comment">#error_log  logs/error.log  info;</span><br><br><span class="hljs-comment">#pid        logs/nginx.pid;</span><br><br>events &#123;<br>    worker_connections  1024;<br>&#125;<br><br>http &#123;<br>	include       mime.types;<br>    default_type  application/octet-stream;<br>    <br>    <span class="hljs-comment">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br>    <span class="hljs-comment">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br>    <span class="hljs-comment">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><br>    <span class="hljs-comment">#access_log  logs/access.log  main;</span><br><br>    sendfile        on;<br>    <span class="hljs-comment">#tcp_nopush     on;</span><br><br>    <span class="hljs-comment">#keepalive_timeout  0;</span><br>    keepalive_timeout  65;<br>    <br>	<span class="hljs-comment"># websocket配置</span><br>	map <span class="hljs-variable">$http_upgrade</span> <span class="hljs-variable">$connection_upgrade</span> &#123;<br>		default keep-alive;<br>		<span class="hljs-string">&#x27;websocket&#x27;</span> upgrade;<br>    &#125;<br>    <br>    server&#123;<br>        port  80;<br>        server_name  localhost;<br><br>		<span class="hljs-comment"># 请求实体大小限制</span><br>        client_max_body_size 10m;<br><br>        location / &#123;<br>            root   html;<br>            index  index.html index.htm;<br>        &#125;<br>        <br>        <span class="hljs-comment"># 转到后台</span><br>        location /api &#123;<br>            proxy_pass http://127.0.0.1:81/api;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h3><p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">http &#123;<br>    server&#123;<br>        port  80;<br>        server_name  localhost;<br><br>        location / &#123;<br>            proxy_pass  http://192.168.2.321:81;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="https-转发"><a href="#https-转发" class="headerlink" title="https 转发"></a>https 转发</h3><p>获取 ssl 证书，一个 <code>.key</code> 文件和一个 <code>.pem</code> 文件，拷贝到 <code>/opt/cert/</code>中</p>
<p>nginx 需要安装 ssl 模块 ngx_http_ssl_module</p>
<p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">http &#123;<br>    server&#123;<br>        port  443 ssl;<br>        server_name  abc123.com;<br><br>		ssl_certificate		/opt/cert/xxx_abc123.com.pem;<br>        ssl_certificate_key	/opt/cert/xxx_abc123.com.key;<br><br>        location / &#123;<br>            proxy_pass  https://192.168.2.321:81;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="同端口-http-自动跳转-https"><a href="#同端口-http-自动跳转-https" class="headerlink" title="同端口 http 自动跳转 https"></a>同端口 http 自动跳转 https</h4><p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/haolb123/p/16553020.html">nginx_非标准端口_同端口_http_自动跳转_https</a></p>
<p>用 error_page 拦截 497 实现 http 跳转 https，在 <code>server &#123; .. &#125;</code> 中加入一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">error_page 497 https://<span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span><span class="hljs-variable">$request_uri</span>; <span class="hljs-comment">#默认用302,临时重定向</span><br><span class="hljs-comment">#或</span><br>error_page 497 =301 https://<span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span><span class="hljs-variable">$request_uri</span>; <span class="hljs-comment">#永久重定向</span><br><span class="hljs-comment">#或</span><br>error_page 497 =307 https://<span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span><span class="hljs-variable">$request_uri</span>; <span class="hljs-comment">#临时重定向,不改变请求的方法(如post还是post)</span><br></code></pre></td></tr></table></figure>

<h3 id="websocket-转发"><a href="#websocket-转发" class="headerlink" title="websocket 转发"></a>websocket 转发</h3><p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">http &#123;<br>    server&#123;<br>        ......<br><br>        <span class="hljs-comment"># 自定义变量 $connection_upgrade</span><br>        map <span class="hljs-variable">$http_upgrade</span> <span class="hljs-variable">$connection_upgrade</span> &#123;<br>            default          keep-alive;  <span class="hljs-comment">#默认为keep-alive 可以支持 一般http请求</span><br>            <span class="hljs-string">&#x27;websocket&#x27;</span>      upgrade;     <span class="hljs-comment">#如果为websocket 则为 upgrade 可升级的。</span><br>        &#125;<br><br>        location /websocket/ &#123;<br>            proxy_pass http://127.0.0.1:8080/websocket/;<br>            proxy_http_version 1.1;<br>            proxy_set_header Upgrade <span class="hljs-variable">$http_upgrade</span>; <span class="hljs-comment">#此处配置 上面定义的变量</span><br>            proxy_set_header Connection <span class="hljs-variable">$connection_upgrade</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="stream-转发"><a href="#stream-转发" class="headerlink" title="stream 转发"></a>stream 转发</h3><p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">stream &#123;<br>  server &#123;<br>    listen 80;<br>    proxy_pass 192.168.2.321:81;<br>  &#125;<br>&#125;<br><br>http &#123;<br>    server&#123;<br>        ......<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意 stream 与 http 平级</p>
<h3 id="gzip-压缩"><a href="#gzip-压缩" class="headerlink" title="gzip 压缩"></a>gzip 压缩</h3><p>nginx.conf 的 http 中加入以下片断</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># gzip config</span><br>gzip on;<br>gzip_min_length 10k;<br>gzip_buffers 4 16k;<br>gzip_http_version 1.1;<br>gzip_comp_level 6;<br>gzip_types text/plain text/css text/javascript text/xml application/json application/javascript application/x-javascript application/xml application/x-httpd-php image/jpeg image/gif image/png;<br>gzip_vary on;<br>gzip_disable <span class="hljs-string">&quot;MSIE [1-6]\.&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>前端需要使用 compression-webpack-plugin 插件压缩文件</p>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p>nginx 需要安装日志模块 ngx_http_log_module</p>
<p>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">http &#123;<br>    server&#123;<br>        port  80;<br>        server_name  localhost;<br><br>        location / &#123;<br>            proxy_pass  http://192.168.2.321:81;<br>            access_log  /usr/<span class="hljs-built_in">local</span>/nginx/logs/a.log;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>重启后通过 <code>location /</code> 的日志将会输出到 <code>/usr/local/nginx/logs/a.log</code></p>
<h3 id="location-与-proxy-pass-的-url-后加与不加-的区别"><a href="#location-与-proxy-pass-的-url-后加与不加-的区别" class="headerlink" title="location 与 proxy_pass 的 url 后加与不加 / 的区别"></a>location 与 proxy_pass 的 url 后加与不加 / 的区别</h3><p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/baixing/p/15847820.html">NGINX配置 —— location 与 proxy_pass的url后 加与不加 / 的区别</a></p>
<p>请求网站为：192.168.1.123:80/static/a.html<br>nginx.conf 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">server&#123;<br>    port  80;<br>    server_name  localhost;<br><br>    location /static &#123;<br>        proxy_pass  192.168.2.321:81;<br>    &#125;<br><br>    location /static &#123;<br>        proxy_pass  192.168.2.321:81/;<br>    &#125;<br><br>    location /static/ &#123;<br>        proxy_pass  192.168.2.321:81;<br>    &#125;<br><br>    location /static/ &#123;<br>        proxy_pass  192.168.2.321:81/;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>第一种 location 后无 <code>/</code> proxy_pass 后无 <code>/</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 192.168.1.123-&gt;server name</span><br><span class="hljs-comment"># :80 ---------&gt; port</span><br><span class="hljs-comment"># /statc -------&gt;location</span><br><span class="hljs-comment"># /a.html ------&gt;proxy_pass </span><br><br>location /static &#123;<br>	proxy_pass  192.168.2.321:81;<br>&#125;<br><br>最后网址经过nginx转向到的网址是 192.168.2.321:81/static/a.html<br></code></pre></td></tr></table></figure>

<ul>
<li>第二种 location 后无 <code>/</code> proxy_pass 后有 <code>/</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 192.168.1.123----&gt;server name</span><br><span class="hljs-comment"># :80 ------------&gt; port</span><br><span class="hljs-comment"># /statc ----------&gt;location</span><br><span class="hljs-comment"># /a.html ---------&gt;proxy_pass </span><br><br>location /static &#123;<br>	proxy_pass  192.168.2.321:81/;<br>&#125;<br><br>最后网址经过nginx转向到的网址是 192.168.2.321:81/a.html<br></code></pre></td></tr></table></figure>

<ul>
<li>第三种 location 后有 <code>/</code> proxy_pass 后无 <code>/</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 192.168.1.123--&gt;server name</span><br><span class="hljs-comment"># :80 ------------&gt; port</span><br><span class="hljs-comment"># /statc/ ----------&gt;location</span><br><span class="hljs-comment"># a.html ---------&gt;proxy_pass </span><br><br>location /static/ &#123;<br>	proxy_pass  192.168.2.321:81;<br>&#125;<br><br>最后网址经过nginx转向到的网址是 192.168.2.321:81/static/a.html<br></code></pre></td></tr></table></figure>

<ul>
<li>第四种 location 后有 <code>/</code> proxy_pass 后有 <code>/</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 192.168.1.123--&gt;server name</span><br><span class="hljs-comment"># :80 ------------&gt; port</span><br><span class="hljs-comment"># /statc/ ----------&gt;location（path1）</span><br><span class="hljs-comment"># a.html ---------&gt;proxy_pass （path2）</span><br><br>location /static/ &#123;<br>	proxy_pass  192.168.2.321:81/;<br>&#125;<br><br>最后网址经过nginx转向到的网址是 192.168.2.321:81/a.html<br></code></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>当 proxy_pass 内容是 ip:port/ 时nginx最后代理到的网址是 proxy_pass(内容)<br>当 proxy_pass 内容是 ip:port 时nginx最后代理到的网址是 location(内容) + proxy_pass(内容)</p>
<p>location内容是什么不太影响结果</p><div id="paginator"></div></div><div id="post-footer"><hr><a href="/2022/06/23/CentOS7-%E9%83%A8%E7%BD%B2-ZlMediaKit/">CentOS7 部署 ZlMediaKit Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: ''
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/shanliangLS"> Dr.Shining</a></h1><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">29</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">21</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">7</span></div></section></div><div id="aside-block"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%96%B0%E6%A8%A1%E5%9D%97"><span class="toc-number">1.1.</span> <span class="toc-text">安装新模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.1.</span> <span class="toc-text">部署系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">2.2.</span> <span class="toc-text">正向代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#https-%E8%BD%AC%E5%8F%91"><span class="toc-number">2.3.</span> <span class="toc-text">https 转发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E7%AB%AF%E5%8F%A3-http-%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AC-https"><span class="toc-number">2.3.1.</span> <span class="toc-text">同端口 http 自动跳转 https</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#websocket-%E8%BD%AC%E5%8F%91"><span class="toc-number">2.4.</span> <span class="toc-text">websocket 转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream-%E8%BD%AC%E5%8F%91"><span class="toc-number">2.5.</span> <span class="toc-text">stream 转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gzip-%E5%8E%8B%E7%BC%A9"><span class="toc-number">2.6.</span> <span class="toc-text">gzip 压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-number">2.7.</span> <span class="toc-text">日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#location-%E4%B8%8E-proxy-pass-%E7%9A%84-url-%E5%90%8E%E5%8A%A0%E4%B8%8E%E4%B8%8D%E5%8A%A0-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.8.</span> <span class="toc-text">location 与 proxy_pass 的 url 后加与不加 &#x2F; 的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.8.1.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li></ol></div></div><footer><nobr><span class="text-title">©</span><span class="text-content">github.com/shanliangLS</span></nobr><wbr><wbr><nobr>published with&nbsp;<a target="_blank" rel="noopener" href="http://hexo.io">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight&nbsp;</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>